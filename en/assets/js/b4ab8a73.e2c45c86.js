"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5962],{68593:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>d,default:()=>o,frontMatter:()=>u,metadata:()=>r,toc:()=>a});var i=t(85893),s=t(11151);const u={sidebar_position:3},d="GPADC\u68c0\u6d4b\u6309\u952e",r={id:"T113i-Industrial/part6/GPADCKeyDetection",title:"GPADC\u68c0\u6d4b\u6309\u952e",description:"1.GPADC",source:"@site/docs/T113i-Industrial/part6/03-GPADCKeyDetection.md",sourceDirName:"T113i-Industrial/part6",slug:"/T113i-Industrial/part6/GPADCKeyDetection",permalink:"/en/docs/T113i-Industrial/part6/GPADCKeyDetection",draft:!1,unlisted:!1,editUrl:"https://github.com/100askTeam/linuxboard-docs/tree/main/docs/T113i-Industrial/part6/03-GPADCKeyDetection.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"t113iSidebar",previous:{title:"\u5f00\u53d1\u73af\u5883\u642d\u5efa",permalink:"/en/docs/T113i-Industrial/part6/DevelopmentEnvironmentSetup"},next:{title:"\u652f\u6301RS485\u529f\u80fd",permalink:"/en/docs/T113i-Industrial/part6/SupportRS485Function"}},c={},a=[{value:"1.GPADC",id:"1gpadc",level:2},{value:"1.1 GPADC\u786c\u4ef6\u4ecb\u7ecd",id:"11-gpadc\u786c\u4ef6\u4ecb\u7ecd",level:3},{value:"1.2 GPADC\u8f6f\u4ef6\u914d\u7f6e",id:"12-gpadc\u8f6f\u4ef6\u914d\u7f6e",level:3},{value:"2.\u6d4b\u8bd5\u6309\u952e",id:"2\u6d4b\u8bd5\u6309\u952e",level:2},{value:"2.1 hexdump\u6d4b\u8bd5",id:"21-hexdump\u6d4b\u8bd5",level:3},{value:"2.2 C\u7a0b\u5e8f\u6d4b\u8bd5",id:"22-c\u7a0b\u5e8f\u6d4b\u8bd5",level:3}];function l(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.a)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h1,{id:"gpadc\u68c0\u6d4b\u6309\u952e",children:"GPADC\u68c0\u6d4b\u6309\u952e"}),"\n",(0,i.jsx)(e.h2,{id:"1gpadc",children:"1.GPADC"}),"\n",(0,i.jsx)(e.p,{children:"GPADC\uff08General Purpose Analog to Digital Converter\uff09\u662f\u6307\u9ad8\u7cbe\u5ea6\u6570\u6a21\u8f6c\u6362\u6a21\u5757\uff0c\u62e5\u670912bit\u5206\u8fa8\u7387\uff0c8\u4f4d\u91c7\u96c6\u7cbe\u5ea6\u3002\u6a21\u62df\u8f93\u5165\u8303\u56f40~1.8V\uff0c\u6700\u9ad8\u91c7\u6837\u73871MHz\u3002"}),"\n",(0,i.jsx)(e.p,{children:"GPADC \u9a71\u52a8\u8def\u5f84\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"t113i_tinasdk5.0-v1/kernel/linux-5.4/drivers/input/sensor/sunxi_gpadc.c\nt113i_tinasdk5.0-v1/kernel/linux-5.4/drivers/input/sensor/sunxi_gpadc.h\n"})}),"\n",(0,i.jsx)(e.h3,{id:"11-gpadc\u786c\u4ef6\u4ecb\u7ecd",children:"1.1 GPADC\u786c\u4ef6\u4ecb\u7ecd"}),"\n",(0,i.jsx)(e.p,{children:"\u67e5\u770b\u539f\u7406\u56fe\uff0c\u5982\u4e0b\uff1a"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"image-20240717142644688",src:t(16027).Z+"",width:"1217",height:"294"})}),"\n",(0,i.jsx)(e.p,{children:"AVCC \u4e3a 1.8V \u7535\u6e90\u4f9b\u7535\uff0c\u901a\u8fc7\u4e00\u4e2a\u7535\u963b\u4e32\u8054\u5230GPADC\u7684\u6309\u952e\u7ec4\u3002\u6309\u952e\u901a\u8fc7\u4e0d\u540c\u963b\u503c\u7684\u7535\u963b\u76f8\u8fde\u63a5\uff0c\u6309\u4e0b\u4e0d\u540c\u7684\u6309\u952e\uff0cGPADC0 \u53e3\u7684\u7535\u538b\u4e0d\u540c\uff0cCPU \u901a\u8fc7\u5bf9\u8fd9\u4e2a\u7535\u538b\u7684\u91c7\u6837\u6765\u51b3\u5b9a\u5177\u4f53\u662f\u54ea\u4e00\u4e2a\u6309\u952e\u88ab\u6309\u4e0b\u3002\u4e0a\u56fe\u6309\u952e\u4e0e\u7535\u538b\u7684\u5bf9\u5e94\u5173\u7cfb\u5982\u4e0b\u8868\u6240\u793a\uff1a"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"0.21V"}),(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"0.41V"}),(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"0.59V"})]})}),(0,i.jsx)(e.tbody,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"VOL+"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"VOL-"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"MENU"})]})})]}),"\n",(0,i.jsxs)(e.p,{children:["\u5f53\u6309\u952e\u6309\u4e0b\u65f6\uff0c\u4f1a\u89e6\u53d1 GPADC \u6a21\u5757\u7684\u4e2d\u65ad\uff0cCPU \u4f1a\u91c7\u96c6 GPADC \u7684\u6570\u636e\uff0c\u91c7\u96c6\u5230\u7684\u6570\u636e\u8f6c\u6362\u6210\u76f8\u5e94\u7684\u952e\u503c\u4e4b\u540e\u901a\u8fc7 input \u5b50\u7cfb\u7edf\u4e0a\u4f20\u5230 ",(0,i.jsx)(e.code,{children:"/dev/input/event"})," \u8282\u70b9\uff0c\u7a0b\u5e8f\u4fbf\u53ef\u4ee5\u4ece\u76f8\u5e94\u7684\u8282\u70b9\u83b7\u53d6\u6570\u636e\u3002"]}),"\n",(0,i.jsx)(e.h3,{id:"12-gpadc\u8f6f\u4ef6\u914d\u7f6e",children:"1.2 GPADC\u8f6f\u4ef6\u914d\u7f6e"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u8bbe\u5907\u6811\u914d\u7f6e"})}),"\n",(0,i.jsx)(e.p,{children:"GPADC \u7684\u8bbe\u5907\u6811\u914d\u7f6e\u5206\u4e3a\u4e24\u4e2a\u90e8\u5206\uff1a"}),"\n",(0,i.jsxs)(e.p,{children:["\u7b2c\u4e00\u90e8\u5206\u5305\u62ec\u57fa\u7840\u7684\u5bc4\u5b58\u5668\u914d\u7f6e\u3001\u8bbe\u5907\u9a71\u52a8\u7ed1\u5b9a\u914d\u7f6e\u548c\u65f6\u949f\u4e2d\u65ad\u914d\u7f6e\u3002\u8fd9\u4e00\u90e8\u5206\u7684\u914d\u7f6e\u4f4d\u4e8e ",(0,i.jsx)(e.code,{children:"t113i_tinasdk5.0-v1/kernel/linux-5.4/arch/arm/boot/dts/sun8iw20p1.dtsi"})," \u6587\u4ef6\u5185\u3002",(0,i.jsx)(e.strong,{children:"\u8fd9\u4e00\u90e8\u5206\u901a\u5e38\u4e0d\u9700\u8981\u4fee\u6539\u3002"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'gpadc: gpadc@2009000 {\n        compatible = "allwinner,sunxi-gpadc";\n        reg = <0x0 0x02009000 0x0 0x400>;\n        interrupts = <GIC_SPI 57 IRQ_TYPE_LEVEL_HIGH>;\n        clocks = <&ccu CLK_BUS_GPADC>;\n        clock-names = "bus";\n        resets = <&ccu RST_BUS_GPADC>;\n        status = "okay";\n};\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u7b2c\u4e8c\u90e8\u5206\u5305\u62ec\u91c7\u6837\u76f8\u5173\u7684\u914d\u7f6e\uff0c\u952e\u503c\uff0c\u7535\u538b\u6570\u636e\u7b49\u7b49\uff0c\u5728 ",(0,i.jsx)(e.code,{children:"t113i_tinasdk5.0-v1/device/config/chips/t113_i/configs/evb1_auto/linux-5.4/board.dts"})," \u6587\u4ef6\u5185\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'&gpadc {\n        channel_num = <1>;\n        channel_select = <0x1>;\n        channel_data_select = <0>;\n        channel_compare_select = <0x1>;\n        channel_cld_select = <0x1>;\n        channel_chd_select = <0>;\n        channel0_compare_lowdata = <1700000>;\n        channel0_compare_higdata = <1200000>;\n        channel1_compare_lowdata = <460000>;\n        channel1_compare_higdata = <1200000>;\n        key_cnt = <5>;\n        key0_vol = <210>;\n        key0_val = <115>;\n        key1_vol = <410>;\n        key1_val = <114>;\n        key2_vol = <590>;\n        key2_val = <119>;\n        key3_vol = <750>;\n        key3_val = <373>;\n        key4_vol = <880>;\n        key4_val = <28>;\n        status = "okay";\n};\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5185\u6838\u9a71\u52a8\u914d\u7f6e"})}),"\n",(0,i.jsxs)(e.p,{children:["\u8fdb\u5165\u6e90\u7801\u6839\u76ee\u5f55",(0,i.jsx)(e.code,{children:"t113i_tinasdk5.0-v1/"})]}),"\n",(0,i.jsxs)(e.p,{children:["\u6267\u884c",(0,i.jsx)(e.code,{children:"./build.sh menuconfig"}),"\uff0c\u627e\u5230",(0,i.jsx)(e.code,{children:"Device Drivers"}),"\uff0c\u8fdb\u5165\u3002"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"image-20240717112142534",src:t(12355).Z+"",width:"1659",height:"890"})}),"\n",(0,i.jsxs)(e.p,{children:["\u627e\u5230 ",(0,i.jsx)(e.code,{children:"Input device support "}),"\uff0c\u8fdb\u5165\u3002"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"image-20240717112421876",src:t(95674).Z+"",width:"1659",height:"890"})}),"\n",(0,i.jsxs)(e.p,{children:["\u627e\u5230 ",(0,i.jsx)(e.code,{children:"Sensors"})," \u7a7a\u683c\u52fe\u9009\u5e76\u8fdb\u5165\u3002"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"image-20240717112450212",src:t(35403).Z+"",width:"1659",height:"890"})}),"\n",(0,i.jsxs)(e.p,{children:["\u7a7a\u683c\u9009\u4e2d ",(0,i.jsx)(e.code,{children:"<*> sunxi gpadc driver support"})," \uff0c\u4fdd\u5b58\u5e76\u9000\u51fa\u914d\u7f6e\u9875\u9762\u3002"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"image-20240717112532232",src:t(69864).Z+"",width:"1659",height:"890"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5728\u6e90\u7801\u6839\u76ee\u5f55\u4e0a\uff0c\u5148\u7f16\u8bd1\u5185\u6838",(0,i.jsx)(e.code,{children:"./build.sh kernel"}),"\uff0c\u518d\u6267\u884c",(0,i.jsx)(e.code,{children:"./build.sh "}),"\uff0c\u6700\u540e\u6253\u5305",(0,i.jsx)(e.code,{children:"./build.sh pack"}),"\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u6253\u5305\u5b8c\u6210\u540e\uff0c\u751f\u6210\u7684\u56fa\u4ef6\u4fdd\u5b58\u5728 ",(0,i.jsx)(e.code,{children:"t113i_tinasdk5.0-v1/out/t113_i/evb1_auto/buildroot"})," \u76ee\u5f55\u4e0b\uff0c\u955c\u50cf\u662f",(0,i.jsx)(e.code,{children:"t113_i_linux_evb1_auto_uart0.img"}),"\uff1a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"ubuntu@dshanpi:~/meihao/t113i_tinasdk5.0-v1/out/t113_i/evb1_auto/buildroot$ ls -la\ntotal 825244\ndrwxrwxr-x 4 ubuntu ubuntu      4096 7\u6708  17 08:53 .\ndrwxrwxr-x 4 ubuntu ubuntu      4096 7\u6708  16 20:29 ..\n-rw-rw-r-- 1 ubuntu ubuntu         6 7\u6708  17 08:53 arisc\n-rwxrwxr-x 1 ubuntu ubuntu  12986128 7\u6708  17 08:53 bImage\n-rw-rw-r-- 1 ubuntu ubuntu        66 7\u6708  17 08:53 .board.dtb.d.dtc.tmp\n-rw-rw-r-- 1 ubuntu ubuntu     79218 7\u6708  17 08:53 .board.dtb.dts.tmp\n-rw-rw-r-- 1 ubuntu ubuntu     40960 7\u6708  16 16:31 boot0_mmc_car_fastboot_sun8iw20p1.bin\n-rw-rw-r-- 1 ubuntu ubuntu     45056 7\u6708  16 16:31 boot0_mmcfastboot_sun8iw20p1.bin\n-rw-rw-r-- 1 ubuntu ubuntu     49152 7\u6708  16 16:31 boot0_nand_car_fastboot_sun8iw20p1.bin\n-rw-rw-r-- 1 ubuntu ubuntu     53248 7\u6708  16 16:31 boot0_nandfastboot_sun8iw20p1.bin\n-rw-rw-r-- 1 ubuntu ubuntu     49152 7\u6708  16 16:31 boot0_nand_sun8iw20p1.bin\n-rw-rw-r-- 1 ubuntu ubuntu     40960 7\u6708  16 16:31 boot0_sdcard_sun8iw20p1.bin\n-rw-rw-r-- 1 ubuntu ubuntu     32768 7\u6708  16 16:31 boot0_spinor_sun8iw20p1.bin\n-rw-rw-r-- 1 ubuntu ubuntu   9521152 7\u6708  17 08:53 boot.img\n-rw-rw-r-- 1 ubuntu ubuntu      4924 7\u6708  17 08:53 .buildconfig\ndrwxrwxr-x 7 ubuntu ubuntu      4096 7\u6708  17 08:54 buildroot\n-rw-rw-r-- 1 ubuntu ubuntu    127042 7\u6708  17 08:53 .config\nlrwxrwxrwx 1 ubuntu ubuntu        18 7\u6708  17 08:53 dist -> lib/modules/5.4.61\n-rwxrwxr-x 1 ubuntu ubuntu    168392 7\u6708  17 08:53 dtc\n-rw-rw-r-- 1 ubuntu ubuntu     21152 7\u6708  16 16:31 fes1_sun8iw20p1.bin\ndrwxrwxr-x 3 ubuntu ubuntu      4096 7\u6708  17 08:53 lib\n-rw-rw-r-- 1 ubuntu ubuntu   4000287 7\u6708  17 08:53 rootfs.cpio.gz\n-rw-r--r-- 1 ubuntu ubuntu 186701904 7\u6708  17 08:54 rootfs.ext4\n-rw-r--r-- 1 ubuntu ubuntu  58269696 7\u6708  17 08:54 rootfs.squashfs\n-rw-rw-r-- 1 ubuntu ubuntu  86446080 7\u6708  17 08:54 rootfs.ubifs\n-rw-rw-r-- 1 ubuntu ubuntu     86016 7\u6708  16 16:31 sboot_sun8iw20p1.bin\n-rw-rw-r-- 1 ubuntu ubuntu     57824 7\u6708  17 08:53 sunxi.dtb\n-rw-rw-r-- 1 ubuntu ubuntu     67864 7\u6708  16 20:29 .sunxi.dts\n-rw-rw-r-- 1 ubuntu ubuntu   2354346 7\u6708  17 08:53 System.map\n-rwxrwxr-x 2 ubuntu ubuntu 276659200 7\u6708  16 20:29 t113_i_linux_evb1_auto_uart0.img\n-rw-rw-r-- 1 ubuntu ubuntu    981756 7\u6708  16 16:31 u-boot-sun8iw20p1.bin\n-rw-rw-r-- 1 ubuntu ubuntu   5169888 7\u6708  17 08:53 uImage\n-rwxrwxr-x 1 ubuntu ubuntu 136330284 7\u6708  17 08:53 vmlinux\n-rw-rw-r-- 1 ubuntu ubuntu  62050327 7\u6708  17 08:53 vmlinux.tar.bz2\n-rwxrwxr-x 1 ubuntu ubuntu   5169824 7\u6708  17 08:53 zImage\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6839\u636e\u4e4b\u524d\u7684\u70e7\u5f55\u65b9\u5f0f\u8fdb\u884c\u70e7\u5f55\u3002"}),"\n",(0,i.jsx)(e.h2,{id:"2\u6d4b\u8bd5\u6309\u952e",children:"2.\u6d4b\u8bd5\u6309\u952e"}),"\n",(0,i.jsxs)(e.p,{children:["\u70e7\u5f55\u5b8c\u6210\u540e\uff0c\u8fdb\u5165\u5f00\u53d1\u677f\uff0c\u6267\u884c",(0,i.jsx)(e.code,{children:"cat /proc/bus/input/devices"}),",\u67e5\u770b\u5bf9\u5e94\u7684\u8bbe\u5907\u8282\u70b9\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'# cat /proc/bus/input/devices\nI: Bus=0019 Vendor=0001 Product=0001 Version=0100\nN: Name="sunxi-keyboard"\nP: Phys=sunxikbd/input0\nS: Sysfs=/devices/virtual/input/input0\nU: Uniq=\nH: Handlers=kbd event0\nB: PROP=0\nB: EV=3\nB: KEY=1000 800 c0000 0 0 10000000\n\nI: Bus=0019 Vendor=0001 Product=0001 Version=0100\nN: Name="sunxi-ts"\nP: Phys=sunxi_ts/input0\nS: Sysfs=/devices/platform/soc@3000000/2009c00.rtp/input/input1\nU: Uniq=\nH: Handlers=event1\nB: PROP=0\nB: EV=b\nB: KEY=400 0 0 0 0 0 0 0 0 0 0\nB: ABS=3\n\nI: Bus=0019 Vendor=0001 Product=0001 Version=0100\nN: Name="sunxi-gpadc0"\nP: Phys=sunxigpadc0/input0\nS: Sysfs=/devices/virtual/input/input2\nU: Uniq=\nH: Handlers=kbd event2\nB: PROP=0\nB: EV=100003\nB: KEY=200000 0 0 0 0 0 0 0 8c0000 0 0 10000000\n\n#\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u53ef\u4ee5\u770b\u5230",(0,i.jsx)(e.code,{children:"sunxi-gpadc0"}),"\u5bf9\u5e94\u7684\u8bbe\u5907\u8282\u70b9\u662f",(0,i.jsx)(e.code,{children:"/dev/input/event2"}),"\u3002"]}),"\n",(0,i.jsx)(e.h3,{id:"21-hexdump\u6d4b\u8bd5",children:"2.1 hexdump\u6d4b\u8bd5"}),"\n",(0,i.jsxs)(e.p,{children:["\u5728\u5f00\u53d1\u677f\u4e0a\uff0c\u6267\u884c",(0,i.jsx)(e.code,{children:"/dev/input/event2"}),"\uff0c\u68c0\u6d4b\u6309\u952e\u6309\u4e0b\u72b6\u6001\uff1a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# hexdump /dev/input/event2\n0000000 1dcd 0000 b22e 0004 0001 0073 0001 0000\n0000010 1dcd 0000 b22e 0004 0000 0000 0000 0000\n0000020 1dcd 0000 5e10 0007 0001 0073 0000 0000\n0000030 1dcd 0000 5e10 0007 0000 0000 0000 0000\n0000040 1dce 0000 5bbf 0007 0001 0072 0001 0000\n0000050 1dce 0000 5bbf 0007 0000 0000 0000 0000\n0000060 1dce 0000 6374 0009 0001 0072 0000 0000\n0000070 1dce 0000 6374 0009 0000 0000 0000 0000\n0000080 1dcf 0000 4dc5 0005 0001 0077 0001 0000\n0000090 1dcf 0000 4dc5 0005 0000 0000 0000 0000\n00000a0 1dcf 0000 f5bb 0007 0001 0077 0000 0000\n00000b0 1dcf 0000 f5bb 0007 0000 0000 0000 0000\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"image-20240717094803138",src:t(63392).Z+"",width:"1210",height:"587"})}),"\n",(0,i.jsxs)(e.p,{children:["\u53ef\u4ee5\u5728",(0,i.jsx)(e.code,{children:"t113i_tinasdk5.0-v1/device/config/chips/t113_i/configs/evb1_auto/linux-5.4/board.dts"}),"\u91cc\uff0c\u8bbe\u7f6e",(0,i.jsx)(e.code,{children:"key*_val"}),"\u503c\u6765\u81ea\u5b9a\u4e49\u6539\u53d8\u6309\u952e\u6309\u4e0b\u8fd4\u56de\u7684\u503c\u3002"]}),"\n",(0,i.jsx)(e.h3,{id:"22-c\u7a0b\u5e8f\u6d4b\u8bd5",children:"2.2 C\u7a0b\u5e8f\u6d4b\u8bd5"}),"\n",(0,i.jsx)(e.p,{children:"\u4e3a\u4e86\u66f4\u52a0\u76f4\u89c2\u5206\u8fa8\u54ea\u4e2a\u6309\u952e\u6309\u4e0b\u548c\u677e\u5f00\uff0c\u7f16\u5199\u4e00\u4e2ac\u6587\u4ef6\u7528\u4e8e\u8bfb\u53d6\u6309\u952e\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u5728Ubuntu\u4e0a\uff0c\u521b\u5efa\u4e00\u4e2a.c\u6587\u4ef6\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"ubuntu@dshanpi:~/meihao/gpadc_test$ ls -la\ntotal 24\ndrwxrwxr-x 2 ubuntu ubuntu  4096 7\u6708  17 10:48 .\ndrwxrwxr-x 4 ubuntu ubuntu  4096 7\u6708  17 10:21 ..\n-rw-rw-r-- 1 ubuntu ubuntu  1181 7\u6708  17 10:48 gpadc_test.c\nubuntu@dshanpi:~/meihao/gpadc_test$\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5199\u5165\u4ee5\u4e0b\u5185\u5bb9\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'#include <stdio.h>\n#include <linux/input.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <limits.h>\n#include <unistd.h>\n#include <signal.h>\n\n#define DEV_PATH "/dev/input/event2"\n\nstatic int g_igpadc_fd = 0;\n\nstatic int test_gpadc(const char *event_file)\n{\n        int code = 0;\n        int i = 0;\n\n        struct input_event data;\n\n        g_igpadc_fd = open(DEV_PATH,O_RDONLY);\n        if(g_igpadc_fd <= 0)\n        {\n                printf("open %s error!\\n",DEV_PATH);\n                return -1;\n        }\n\n        for(i = 0;i < 20;i++)\n        {\n                read(g_igpadc_fd,&data,sizeof(data));\n\n                /*\u5982\u679c\u6309\u4e0b\u6309\u952e*/\n                if(data.type == EV_KEY && data.value == 1)\n                {\n                        if(data.code == 115)\n                        {\n                                code = 1;\n                        }else if(data.code == 114)\n                        {\n                                code = 2;\n                        }else if(data.code == 119)\n                        {\n                                code = 3;\n                        }\n                        printf("k%d pressed\\n",code);\n                        code = 0;\n                }\n                else if(data.type == EV_KEY && data.value == 0)\n                {\n                        if(data.code == 115)\n                        {\n                                code = 1;\n                        }else if(data.code == 114)\n                        {\n                                code = 2;\n                        }else if(data.code == 119)\n                        {\n                                code = 3;\n                        }\n                        printf("k%d releaseed\\n",code);\n                        code = 0;\n                }\n        }\n\n        close(g_igpadc_fd);\n        return 0;\n}\n\nint main()\n{\n        return test_gpadc(DEV_PATH);\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u7f16\u8bd1\u4e4b\u524d\uff0c\u5148\u627e\u5230\u76f8\u5e94\u7684\u4ea4\u53c9\u7f16\u8bd1\u5de5\u5177\uff0c\u5728\u6e90\u7801\u6839\u76ee\u5f55",(0,i.jsx)(e.code,{children:"t113i_tinasdk5.0-v1/"}),"\u4e0a\uff0c\u67e5\u770b",(0,i.jsx)(e.code,{children:".buildconfig"}),"\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"ubuntu@dshanpi:~/meihao/t113i_tinasdk5.0-v1$ vim .buildconfig\n...\nexport LICHEE_TOOLCHAIN_PATH=/home/ubuntu/meihao/t113i_tinasdk5.0-v1/out/toolchain/gcc-linaro-5.3.1-2016.05-x86_64_arm-linux-gnueabi\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"image-20240717120030950",src:t(55939).Z+"",width:"1657",height:"324"})}),"\n",(0,i.jsxs)(e.p,{children:["\u53ef\u4ee5\u770b\u5230\u4ea4\u53c9\u7f16\u8bd1\u5de5\u5177\u662f",(0,i.jsx)(e.code,{children:"t113i_tinasdk5.0-v1/out/toolchain/gcc-linaro-5.3.1-2016.05-x86_64_arm-linux-gnueabi/bin/arm-linux-gnueabi-gcc"}),"\u3002"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"image-20240717120259883",src:t(60143).Z+"",width:"1649",height:"147"})}),"\n",(0,i.jsxs)(e.p,{children:["\u6267\u884c",(0,i.jsx)(e.code,{children:"t113i_tinasdk5.0-v1/out/toolchain/gcc-linaro-5.3.1-2016.05-x86_64_arm-linux-gnueabi/bin/arm-linux-gnueabi-gcc gpadc_test.c -o gpadc_test"}),"\u7f16\u8bd1\u5e94\u7528\u7a0b\u5e8f\uff0c\u8fd9\u91cc\u7684\u4ea4\u53c9\u7f16\u8bd1\u5de5\u5177\u8def\u5f84\u9700\u8981\u6539\u4e3a\u5b9e\u9645\u7684\u8def\u5f84\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"ubuntu@dshanpi:~/meihao/gpadc_test$ /home/ubuntu/meihao/t113i_tinasdk5.0-v1/out/toolchain/gcc-linaro-5.3.1-2016.05-x86_64_arm-linux-gnueabi/bin/arm-linux-gnueabi-gcc gpadc_test.c -o gpadc_test\nubuntu@dshanpi:~/meihao/gpadc_test$\nubuntu@dshanpi:~/meihao/gpadc_test$ ls -la\ntotal 24\ndrwxrwxr-x 2 ubuntu ubuntu  4096 7\u6708  17 12:07 .\ndrwxrwxr-x 4 ubuntu ubuntu  4096 7\u6708  17 10:21 ..\n-rwxrwxr-x 1 ubuntu ubuntu 10652 7\u6708  17 12:07 gpadc_test\n-rw-rw-r-- 1 ubuntu ubuntu  1181 7\u6708  17 10:48 gpadc_test.c\nubuntu@dshanpi:~/meihao/gpadc_test$ file gpadc_test\ngpadc_test: ELF 32-bit LSB executable, ARM, EABI5 version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.3, for GNU/Linux 2.6.32, BuildID[sha1]=b8a92558e4a8aa4ea8ef04018054c8d4e55de7ff, with debug_info, not stripped\nubuntu@dshanpi:~/meihao/gpadc_test$\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u7f16\u8bd1\u6210\u529f\u540e\uff0c\u628a\u53ef\u6267\u884c\u7a0b\u5e8f",(0,i.jsx)(e.code,{children:"gpadc_test"}),"\u4e0a\u4f20\u5230\u5f00\u53d1\u677f\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"ubuntu@dshanpi:~/meihao/gpadc_test$ adb push gpadc_test /mnt/UDISK/\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6267\u884c\u7a0b\u5e8f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# cd /mnt/UDISK/\n# ls\ngpadc_test\n## cd gpadc_test/\n# ls\ngpadc_test    gpadc_test.c\n# ./gpadc_test\nk1 pressed\nk1 releaseed\nk2 pressed\nk2 releaseed\nk3 pressed\nk3 releaseed\nk1 pressed\nk1 releaseed\nk2 pressed\nk2 releaseed\n#\n"})})]})}function o(n={}){const{wrapper:e}={...(0,s.a)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(l,{...n})}):l(n)}},63392:(n,e,t)=>{t.d(e,{Z:()=>i});const i=t.p+"assets/images/image-20240717094803138-3ed07b88a60173ec2e54076c33775f52.png"},12355:(n,e,t)=>{t.d(e,{Z:()=>i});const i=t.p+"assets/images/image-20240717112142534-3427870425703f253d7d4056c51b3d8e.png"},95674:(n,e,t)=>{t.d(e,{Z:()=>i});const i=t.p+"assets/images/image-20240717112421876-933c27c88f91d928f38c573aa0a47793.png"},35403:(n,e,t)=>{t.d(e,{Z:()=>i});const i=t.p+"assets/images/image-20240717112450212-c8ab09b87ee88def8ca6a8453abe9170.png"},69864:(n,e,t)=>{t.d(e,{Z:()=>i});const i=t.p+"assets/images/image-20240717112532232-ad112319f7af7f87afd8adead405d38f.png"},55939:(n,e,t)=>{t.d(e,{Z:()=>i});const i=t.p+"assets/images/image-20240717120030950-4d72dbfa4fe7bde4a71ce21109f2a901.png"},60143:(n,e,t)=>{t.d(e,{Z:()=>i});const i=t.p+"assets/images/image-20240717120259883-cb21c2aa46f2e903bd8c151f69ec2385.png"},16027:(n,e,t)=>{t.d(e,{Z:()=>i});const i=t.p+"assets/images/image-20240717142644688-110675b6a11a260bf36e4bd4bf3452b7.png"},11151:(n,e,t)=>{t.d(e,{Z:()=>r,a:()=>d});var i=t(67294);const s={},u=i.createContext(s);function d(n){const e=i.useContext(u);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:d(n.components),i.createElement(u.Provider,{value:e},n.children)}}}]);